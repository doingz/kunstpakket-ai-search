<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Widget Test - Zonder ?f=1</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 800px;
      margin: 2rem auto;
      padding: 2rem;
    }
    .info {
      background: #f0f9ff;
      border-left: 4px solid #3b82f6;
      padding: 1rem;
      margin-bottom: 2rem;
    }
    .status {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 1rem;
      margin-bottom: 2rem;
    }
    a {
      color: #3b82f6;
      text-decoration: none;
      font-weight: 600;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>üß™ Widget Test Pagina</h1>
  
  <div class="info">
    <strong>Test scenario:</strong> Deze pagina laadt widget.js ZONDER ?f=1 parameter.
    <br><br>
    <strong>Verwacht gedrag:</strong> De widget zou NIET moeten verschijnen.
  </div>
  
  <div class="status" id="status">
    ‚è≥ Checking widget status...
  </div>
  
  <h2>Links om te testen:</h2>
  <ul style="line-height: 2;">
    <li>
      <a href="/test.html">Deze pagina zonder ?f=1</a>
      ‚Üí Widget zou NIET moeten laden
    </li>
    <li>
      <a href="/test.html?f=1">Deze pagina MET ?f=1</a>
      ‚Üí Widget ZOU moeten laden EN blijven voor sessie
    </li>
    <li>
      <a href="javascript:sessionStorage.clear();location.reload()">
        Clear session + reload
      </a>
      ‚Üí Reset sessie
    </li>
  </ul>
  
  <!-- Widget mount point -->
  <div data-kp-search></div>
  
  <!-- Load widget -->
  <script src="/widget.js"></script>
  
  <script>
    // Check status after widget loads
    setTimeout(() => {
      const statusEl = document.getElementById('status');
      const widgetExists = document.getElementById('kp-ai-search-widget');
      const sessionEnabled = sessionStorage.getItem('kp_search_enabled');
      const hasF1 = new URLSearchParams(window.location.search).get('f') === '1';
      
      statusEl.innerHTML = `
        <strong>Status:</strong><br>
        ‚Ä¢ Widget element exists: ${widgetExists ? '‚úÖ YES' : '‚ùå NO'}<br>
        ‚Ä¢ Session storage enabled: ${sessionEnabled === 'true' ? '‚úÖ YES' : '‚ùå NO'}<br>
        ‚Ä¢ ?f=1 in URL: ${hasF1 ? '‚úÖ YES' : '‚ùå NO'}<br>
        ‚Ä¢ KunstpakketSearch.isEnabled(): ${window.KunstpakketSearch?.isEnabled() ? '‚úÖ YES' : '‚ùå NO'}
      `;
      
      if (!widgetExists && !hasF1 && sessionEnabled !== 'true') {
        statusEl.style.background = '#dcfce7';
        statusEl.style.borderColor = '#22c55e';
        statusEl.innerHTML += '<br><br><strong>‚úÖ CORRECT:</strong> Widget laadt niet zonder ?f=1';
      } else if (widgetExists && (hasF1 || sessionEnabled === 'true')) {
        statusEl.style.background = '#dcfce7';
        statusEl.style.borderColor = '#22c55e';
        statusEl.innerHTML += '<br><br><strong>‚úÖ CORRECT:</strong> Widget laadt met ?f=1 of actieve sessie';
      } else {
        statusEl.style.background = '#fee2e2';
        statusEl.style.borderColor = '#ef4444';
        statusEl.innerHTML += '<br><br><strong>‚ùå FOUT:</strong> Onverwacht gedrag!';
      }
    }, 500);
  </script>
</body>
</html>

